# Quickstart Guide: shadcn/ui Migration

**Feature**: 002-shadcn-migration
**Date**: 2025-10-19
**Audience**: Developers implementing the migration

## Overview

This guide provides step-by-step instructions for migrating the frontend application from custom components to shadcn/ui components. Follow the phases in order to ensure a safe, incremental migration.

## Prerequisites

- Node.js 18+ installed
- npm or yarn package manager
- Git repository access
- Familiarity with React, TypeScript, and Tailwind CSS

## Phase 0: Setup & Installation

### Step 1: Install shadcn/ui

```bash
cd frontend

# Initialize shadcn (interactive prompts)
npx shadcn@latest init
```

**Configuration Choices**:
- Style: `Default`
- Base color: `Slate`
- CSS variables: `Yes`
- Tailwind config: `tailwind.config.js`
- Import alias components: `@/components`
- Import alias utils: `@/lib/utils`
- React Server Components: `No`
- Write configuration to components.json: `Yes`

### Step 2: Install Dependencies

The init command installs most dependencies. Verify and add any missing:

```bash
npm install lucide-react class-variance-authority clsx tailwind-merge
npm install -D tailwindcss postcss autoprefixer tailwindcss-animate
```

### Step 3: Configure TypeScript Path Aliases

Update `tsconfig.app.json`:
```json
{
  "compilerOptions": {
    // ... existing config ...
    "baseUrl": ".",
    "paths": {
      "@/*": ["./src/*"]
    }
  }
}
```

Update `vite.config.ts`:
```typescript
import path from 'path'
import { defineConfig } from 'vite'
import react from '@vitejs/plugin-react'

export default defineConfig({
  plugins: [react()],
  resolve: {
    alias: {
      '@': path.resolve(__dirname, './src'),
    },
  },
  build: {
    // ... existing build config ...
  },
})
```

### Step 4: Configure Dark Theme

Update `src/index.css` to enable dark mode by default:

```css
@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    /* Light theme variables (generated by shadcn init) */
  }

  .dark {
    --background: 0 0% 10%;           /* #1a1a1a */
    --foreground: 0 0% 98%;           /* rgba(255,255,255,0.87) */
    --card: 0 0% 14%;                 /* #242424 */
    --card-foreground: 0 0% 98%;
    --primary: 232 79% 65%;           /* #646cff */
    --primary-foreground: 0 0% 98%;
    --border: 0 0% 27%;               /* #444 */
    /* ... other CSS variables */
  }
}

/* Set dark theme as default */
html {
  @apply dark;
}
```

### Step 5: Verify Build

```bash
npm run build
npm run check-size
```

Expected output: Build succeeds, bundle size warning if >200KB.

---

## Phase 1: Core Forms Migration (User Story 1 - P1)

### Scenario 1.1: Migrate FolderDialog (Simplest Component)

**Goal**: Replace custom dialog with shadcn Dialog component

**Step 1**: Install shadcn Dialog and dependencies
```bash
npx shadcn@latest add dialog button input label
```

**Step 2**: Update `FolderDialog.tsx`

Before (custom):
```typescript
import './FolderDialog.css';

return (
  <div className="folder-dialog-overlay" onClick={onClose}>
    <div className="folder-dialog" onClick={(e) => e.stopPropagation()}>
      <div className="dialog-header">
        <h2>{folder ? 'Rename Folder' : 'Create New Folder'}</h2>
        <button onClick={onClose} className="btn-close">âœ•</button>
      </div>
      {/* ... form content ... */}
    </div>
  </div>
);
```

After (shadcn):
```typescript
import { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog';
import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import { Label } from '@/components/ui/label';

return (
  <Dialog open={true} onOpenChange={(open) => !open && onClose()}>
    <DialogContent>
      <DialogHeader>
        <DialogTitle>{folder ? 'Rename Folder' : 'Create New Folder'}</DialogTitle>
      </DialogHeader>
      <form onSubmit={handleSubmit} className="space-y-4">
        <div className="space-y-2">
          <Label htmlFor="folderName">Folder Name</Label>
          <Input
            id="folderName"
            value={name}
            onChange={(e) => setName(e.target.value)}
            placeholder="Enter folder name"
            autoFocus
            disabled={isLoading}
          />
          {error && <p className="text-sm text-destructive">{error}</p>}
        </div>
        <div className="flex justify-end gap-2">
          <Button type="button" variant="outline" onClick={onClose} disabled={isLoading}>
            Cancel
          </Button>
          <Button type="submit" disabled={isLoading}>
            {isLoading ? 'Saving...' : folder ? 'Rename' : 'Create'}
          </Button>
        </div>
      </form>
    </DialogContent>
  </Dialog>
);
```

**Step 3**: Remove `FolderDialog.css`
```bash
rm src/components/folders/FolderDialog.css
```

**Step 4**: Test
- [ ] Create new root folder
- [ ] Create subfolder
- [ ] Rename folder
- [ ] Validation errors display correctly
- [ ] Escape key closes dialog
- [ ] Loading state shows on button

---

### Scenario 1.2: Migrate TemplateForm (Complex Form)

**Goal**: Replace all custom form inputs with shadcn components

**Step 1**: Install shadcn form components
```bash
npx shadcn@latest add textarea select
```

**Step 2**: Update `TemplateForm.tsx`

Key changes:
```typescript
import { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog';
import { Input } from '@/components/ui/input';
import { Textarea } from '@/components/ui/textarea';
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';
import { Button } from '@/components/ui/button';
import { Label } from '@/components/ui/label';

// ... in render ...

<Dialog open={true} onOpenChange={(open) => !open && onClose()}>
  <DialogContent className="max-w-2xl">
    <DialogHeader>
      <DialogTitle>{template ? 'Edit Template' : 'Create New Template'}</DialogTitle>
    </DialogHeader>

    {error && (
      <div className="text-sm text-destructive bg-destructive/10 p-3 rounded-md">
        {error}
      </div>
    )}

    <form onSubmit={handleSubmit} className="space-y-4">
      <div className="space-y-2">
        <Label htmlFor="name">Template Name</Label>
        <Input
          id="name"
          value={name}
          onChange={(e) => setName(e.target.value)}
          placeholder="Enter template name"
          disabled={isLoading}
        />
      </div>

      <div className="space-y-2">
        <Label htmlFor="folder">Folder (Optional)</Label>
        <Select
          value={folderId || ''}
          onValueChange={(value) => setFolderId(value || null)}
          disabled={isLoading}
        >
          <SelectTrigger>
            <SelectValue placeholder="No Folder (Root)" />
          </SelectTrigger>
          <SelectContent>
            <SelectItem value="">No Folder (Root)</SelectItem>
            {flatFolders.map((folder) => (
              <SelectItem key={folder.id} value={folder.id}>
                {'\u00A0'.repeat(folder.level * 2)}{folder.name}
              </SelectItem>
            ))}
          </SelectContent>
        </Select>
      </div>

      <div className="space-y-2">
        <Label htmlFor="content">
          Template Content
          <span className="text-xs text-muted-foreground ml-2">
            Use {'{{'}placeholder_name{'}}'} for placeholders
          </span>
        </Label>
        <Textarea
          id="content"
          value={content}
          onChange={(e) => setContent(e.target.value)}
          placeholder="Enter template content in markdown format"
          rows={15}
          disabled={isLoading}
          className="font-mono"
        />
      </div>

      <div className="flex justify-end gap-2">
        <Button type="button" variant="outline" onClick={onClose} disabled={isLoading}>
          Cancel
        </Button>
        <Button type="submit" disabled={isLoading}>
          {isLoading ? 'Saving...' : template ? 'Update Template' : 'Create Template'}
        </Button>
      </div>
    </form>
  </DialogContent>
</Dialog>
```

**Step 3**: Test
- [ ] Create new template with all fields
- [ ] Edit existing template
- [ ] Folder dropdown shows hierarchy correctly
- [ ] Validation errors display
- [ ] Loading states work
- [ ] Form submission works

---

## Phase 2: Cards & Lists Migration (User Story 2 - P2)

### Scenario 2.1: Migrate TemplateList Cards

**Step 1**: Install card and badge components
```bash
npx shadcn@latest add card badge
```

**Step 2**: Update `TemplateList.tsx`

Before (custom card):
```typescript
<div className="template-card">
  <div className="template-header">
    <h3>{template.name}</h3>
    <div className="template-meta">
      <span className="placeholder-count">{template.placeholderCount} placeholders</span>
    </div>
  </div>
  {/* ... */}
</div>
```

After (shadcn Card):
```typescript
import { Card, CardContent, CardDescription, CardFooter, CardHeader, CardTitle } from '@/components/ui/card';
import { Badge } from '@/components/ui/badge';
import { Button } from '@/components/ui/button';

<Card className="group hover:border-primary/50 transition-colors">
  <CardHeader>
    <div className="flex items-start justify-between">
      <CardTitle>{template.name}</CardTitle>
      {template.placeholderCount > 0 && (
        <Badge variant="secondary">
          {template.placeholderCount} placeholder{template.placeholderCount !== 1 ? 's' : ''}
        </Badge>
      )}
    </div>
    <CardDescription className="line-clamp-3">
      {template.contentPreview}
      {template.contentPreview.length >= 200 && '...'}
    </CardDescription>
  </CardHeader>
  <CardFooter className="flex justify-between">
    <div className="text-xs text-muted-foreground">
      Updated: {new Date(template.updatedAt).toLocaleDateString()}
    </div>
    <div className="flex gap-2">
      <Button size="sm" onClick={() => navigate(`/use/${template.id}`)}>
        Use
      </Button>
      <Button size="sm" variant="outline" onClick={() => handleEdit(template)}>
        Edit
      </Button>
      <Button size="sm" variant="destructive" onClick={() => handleDelete(template.id)}>
        Delete
      </Button>
    </div>
  </CardFooter>
</Card>
```

**Step 3**: Update App.css - remove custom card styles

Remove/comment out:
```css
/* .template-card { ... } */
/* .template-header { ... } */
/* etc. */
```

**Step 4**: Test
- [ ] Template cards render correctly
- [ ] Badges show placeholder counts
- [ ] Button hover states work
- [ ] Empty state displays correctly
- [ ] Dates format correctly

---

## Phase 3: Navigation & Search (User Story 3 - P3)

### Scenario 3.1: Migrate SearchBar with Icon

**Step 1**: Import lucide-react icons
```bash
npm install lucide-react
```

**Step 2**: Update `SearchBar.tsx`

```typescript
import { Input } from '@/components/ui/input';
import { Button } from '@/components/ui/button';
import { Search, X } from 'lucide-react';

export default function SearchBar({ value, onChange, placeholder, isSearching }: SearchBarProps) {
  return (
    <div className="relative w-full">
      <Search className="absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground" />
      <Input
        type="search"
        value={value}
        onChange={(e) => onChange(e.target.value)}
        placeholder={placeholder}
        className="pl-9 pr-9"
        aria-label="Search templates by name or content"
      />
      {isSearching && (
        <span className="absolute right-3 top-1/2 -translate-y-1/2 text-xs text-muted-foreground">
          Searching...
        </span>
      )}
      {!isSearching && value && (
        <Button
          size="sm"
          variant="ghost"
          onClick={() => onChange('')}
          className="absolute right-1 top-1/2 -translate-y-1/2 h-7 w-7 p-0"
        >
          <X className="h-4 w-4" />
        </Button>
      )}
    </div>
  );
}
```

**Step 3**: Test
- [ ] Search icon appears on left
- [ ] Clear button appears when typing
- [ ] Searching indicator shows during search
- [ ] Clear button clears input

### Scenario 3.2: Migrate FolderTree

**Step 1**: Consider shadcn Collapsible

```bash
npx shadcn@latest add collapsible
```

**Step 2**: Update `FolderTree.tsx` (selective migration)

Use lucide-react icons for expand/collapse:
```typescript
import { ChevronDown, ChevronRight, Folder, FolderOpen } from 'lucide-react';
import { Button } from '@/components/ui/button';

// Replace text icons with lucide icons
{hasChildren && (
  <Button
    size="sm"
    variant="ghost"
    className="h-6 w-6 p-0"
    onClick={(e) => {
      e.stopPropagation();
      setIsExpanded(!isExpanded);
    }}
  >
    {isExpanded ? (
      <ChevronDown className="h-4 w-4" />
    ) : (
      <ChevronRight className="h-4 w-4" />
    )}
  </Button>
)}

{isExpanded ? (
  <FolderOpen className="h-4 w-4 text-muted-foreground" />
) : (
  <Folder className="h-4 w-4 text-muted-foreground" />
)}
```

**Step 3**: Remove `FolderTree.css`, replace with Tailwind utilities

**Step 4**: Test
- [ ] Folders expand/collapse
- [ ] Icons render correctly
- [ ] Drag-drop still works
- [ ] Keyboard navigation works

---

## Phase 4: Alerts & Feedback (User Story 4 - P4)

### Scenario 4.1: Replace window.confirm with AlertDialog

**Step 1**: Install AlertDialog
```bash
npx shadcn@latest add alert-dialog
```

**Step 2**: Update TemplateList delete handler

Before:
```typescript
const handleDelete = async (id: string, name: string) => {
  if (window.confirm(`Are you sure you want to delete "${name}"?`)) {
    await deleteMutation.mutateAsync(id);
  }
};
```

After:
```typescript
import {
  AlertDialog,
  AlertDialogAction,
  AlertDialogCancel,
  AlertDialogContent,
  AlertDialogDescription,
  AlertDialogFooter,
  AlertDialogHeader,
  AlertDialogTitle,
} from '@/components/ui/alert-dialog';

const [deleteDialogOpen, setDeleteDialogOpen] = useState(false);
const [templateToDelete, setTemplateToDelete] = useState<{ id: string; name: string } | null>(null);

const handleDeleteClick = (id: string, name: string) => {
  setTemplateToDelete({ id, name });
  setDeleteDialogOpen(true);
};

const confirmDelete = async () => {
  if (templateToDelete) {
    await deleteMutation.mutateAsync(templateToDelete.id);
    setDeleteDialogOpen(false);
    setTemplateToDelete(null);
  }
};

// In render:
<AlertDialog open={deleteDialogOpen} onOpenChange={setDeleteDialogOpen}>
  <AlertDialogContent>
    <AlertDialogHeader>
      <AlertDialogTitle>Are you sure?</AlertDialogTitle>
      <AlertDialogDescription>
        This will permanently delete "{templateToDelete?.name}". This action cannot be undone.
      </AlertDialogDescription>
    </AlertDialogHeader>
    <AlertDialogFooter>
      <AlertDialogCancel>Cancel</AlertDialogCancel>
      <AlertDialogAction onClick={confirmDelete}>Delete</AlertDialogAction>
    </AlertDialogFooter>
  </AlertDialogContent>
</AlertDialog>
```

### Scenario 4.2: Add Skeleton Loading States

**Step 1**: Install Skeleton
```bash
npx shadcn@latest add skeleton
```

**Step 2**: Update TemplateList loading state

Before:
```typescript
if (isLoading) {
  return <div className="loading">Loading templates...</div>;
}
```

After:
```typescript
import { Skeleton } from '@/components/ui/skeleton';

if (isLoading) {
  return (
    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
      {[1, 2, 3, 4, 5, 6].map((i) => (
        <Card key={i}>
          <CardHeader>
            <Skeleton className="h-6 w-3/4" />
            <Skeleton className="h-4 w-full mt-2" />
          </CardHeader>
          <CardFooter>
            <Skeleton className="h-8 w-full" />
          </CardFooter>
        </Card>
      ))}
    </div>
  );
}
```

### Scenario 4.3: Add Toast Notifications

**Step 1**: Install Sonner (toast library)
```bash
npx shadcn@latest add sonner
```

**Step 2**: Add Toaster to App.tsx

```typescript
import { Toaster } from '@/components/ui/sonner';

function App() {
  return (
    <>
      {/* ... existing app content ... */}
      <Toaster />
    </>
  );
}
```

**Step 3**: Use toast in mutations

```typescript
import { toast } from 'sonner';

const createMutation = useMutation({
  mutationFn: (data: CreateTemplateRequest) => templatesApi.create(data),
  onSuccess: () => {
    queryClient.invalidateQueries({ queryKey: ['templates'] });
    toast.success('Template created successfully');
    onClose();
  },
  onError: (err: any) => {
    toast.error(err.response?.data?.message || 'Failed to create template');
  },
});
```

**Step 4**: Test
- [ ] Delete confirmation dialog appears
- [ ] Skeleton loading shows correctly
- [ ] Success toasts appear after create/update/delete
- [ ] Error toasts appear on failures

---

## Verification Checklist

After completing all phases:

### Bundle Size
```bash
npm run build
npm run check-size
```
- [ ] Bundle size <200KB gzipped

### Functionality
- [ ] All forms work (create/edit templates, create/rename folders)
- [ ] All lists work (template list, search results)
- [ ] Navigation works (folder tree, search)
- [ ] Feedback works (confirmations, loading, success/error messages)
- [ ] Drag-drop works (move templates to folders)
- [ ] Keyboard navigation works

### Visual Consistency
- [ ] All buttons use shadcn Button component
- [ ] All inputs use shadcn Input/Textarea components
- [ ] All cards use shadcn Card component
- [ ] All dialogs use shadcn Dialog component
- [ ] Dark theme works correctly
- [ ] Consistent spacing and typography

### Accessibility
- [ ] Screen reader labels preserved/enhanced
- [ ] Keyboard navigation works
- [ ] Focus indicators visible
- [ ] ARIA attributes present

---

## Rollback Plan

If issues arise during migration:

1. **Revert single component**: Git revert the specific commit for that component
2. **Revert entire phase**: Git revert range of commits for that phase
3. **Full rollback**: Merge `main` branch back into feature branch and resolve conflicts

```bash
# Revert last commit (single component)
git revert HEAD

# Revert range (entire phase)
git revert HEAD~3..HEAD

# Abandon feature branch
git checkout main
git branch -D 002-shadcn-migration
```

---

## Next Steps

After migration is complete:
1. Run full manual testing suite
2. Request code review
3. Deploy to staging environment
4. Perform user acceptance testing
5. Merge to main and deploy to production

## Support

For questions or issues during migration:
- Review shadcn/ui documentation: https://ui.shadcn.com
- Review Radix UI documentation: https://radix-ui.com
- Check lucide-react icons: https://lucide.dev/icons
- Consult this repository's CLAUDE.md for project-specific guidance
